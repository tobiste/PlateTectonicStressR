<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tectonicr">
<title>2. Handling large datasets • tectonicr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Handling large datasets">
<meta property="og:description" content="tectonicr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tectonicr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A_tectonicr.html">1. Introduction to tectonicr</a>
    <a class="dropdown-item" href="../articles/B_datasets.html">2. Handling large datasets</a>
    <a class="dropdown-item" href="../articles/C_stress_trajectories.html">3. Plotting trajectories of theoretic stress directions</a>
    <a class="dropdown-item" href="../articles/D_statistics.html">4. Circular statistics</a>
    <a class="dropdown-item" href="../articles/E_interpolation.html">5. Spatial interpolation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tobiste/tectonicr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>2. Handling large datasets</h1>
                        <h4 data-toc-skip class="author">Tobias
Stephan</h4>
            
            <h4 data-toc-skip class="date">2024-05-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tobiste/tectonicr/blob/HEAD/vignettes/B_datasets.Rmd" class="external-link"><code>vignettes/B_datasets.Rmd</code></a></small>
      <div class="d-none name"><code>B_datasets.Rmd</code></div>
    </div>

    
    
<p>This vignette teaches you how to handle large stress datasets and how
to retrieve relative plate motions parameters from a set of plate
motions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tobiste.github.io/tectonicr/">tectonicr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># load ggplot library</span></span></code></pre></div>
<div class="section level2">
<h2 id="larger-data-sets">Larger Data Sets<a class="anchor" aria-label="anchor" href="#larger-data-sets"></a>
</h2>
<p><strong>tectonicr</strong> also handles larger data sets. A subset of
the World Stress Map data compilation (Heidbach et al. 2016) is included
as an example data set and can be imported through:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"san_andreas"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">san_andreas</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 9 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -119.966 ymin: 32.94 xmax: -115.627 ymax: 35.714</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">#&gt;   id         lat   lon   azi   unc type  depth quality regime</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> wsm07786  35.7 -<span style="color: #BB0000;">120.</span>    36     1 HF      1.3 A       S     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> wsm11750  32.9 -<span style="color: #BB0000;">116.</span>     7     1 FMF     7   A       S     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> wsm11759  33.0 -<span style="color: #BB0000;">116.</span>   169     1 FMF     5   A       S     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> wsm11782  33.2 -<span style="color: #BB0000;">116.</span>     1     1 FMF     8   A       S     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> wsm11801  33.9 -<span style="color: #BB0000;">116.</span>    23     1 FMF     6   A       S     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> wsm11830  33.5 -<span style="color: #BB0000;">116.</span>   160     1 FMF     9   A       S     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: geometry &lt;POINT [°]&gt;</span></span></span></code></pre></div>
<p>Modeling the stress directions (wrt. to the geographic North pole)
using the Pole of Oration (PoR) of the motion of North America relative
to the Pacific Pate. We test the dataset against a right-laterally
tangential displacement type.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nuvel1"</span><span class="op">)</span></span>
<span><span class="va">por</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">nuvel1</span>, <span class="va">nuvel1</span><span class="op">$</span><span class="va">plate.rot</span> <span class="op">==</span> <span class="st">"na"</span><span class="op">)</span></span>
<span><span class="va">san_andreas.prd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PoR_shmax.html">PoR_shmax</a></span><span class="op">(</span><span class="va">san_andreas</span>, <span class="va">por</span>, type <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<p>Combine the model results with the coordinates of the observed
data</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">san_andreas.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">san_andreas</span><span class="op">)</span>,</span>
<span>  <span class="va">san_andreas.prd</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="stress-map">Stress map<a class="anchor" aria-label="anchor" href="#stress-map"></a>
</h2>
<p><code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> can be used to visualize the results.
The orientation of the axis can be displayed with the function
<code><a href="https://ggplot2.tidyverse.org/reference/geom_spoke.html" class="external-link">geom_spoke()</a></code>. The position argument
<code>position = "center_spoke"</code> aligns the marker symbol at the
center of the point. The deviation can be color coded.
<code><a href="../reference/deviation_norm.html">deviation_norm()</a></code> yields the normalized value of the
deviation, i.e. absolute values between 0 and 90<span class="math inline">\(^{\circ}\)</span>.</p>
<p>Also included are the plate boundary geometries after Bird
(2003):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"plates"</span><span class="op">)</span> <span class="co"># load plate boundary data set</span></span></code></pre></div>
<p>Alternatively, there is also the NUVEL1 plate boundary model by
DeMets et al. (1990) stored under
<code>data("nuvel1_plates")</code>.</p>
<p>First we create the predicted trajectories of <span class="math inline">\(\sigma_{Hmax}\)</span> (more details in Article
3.):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trajectories</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stress_paths.html">eulerpole_loxodromes</a></span><span class="op">(</span><span class="va">por</span>, <span class="fl">40</span>, cw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Then we initialize the plot <code>map</code>…</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">plates</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_color_continuous</a></span><span class="op">(</span></span>
<span>    type <span class="op">=</span> <span class="st">"viridis"</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"|Deviation| in (\u00B0)"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span>, <span class="fl">22.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html" class="external-link">scale_alpha_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Quality rank"</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>…and add the <span class="math inline">\(\sigma_{Hmax}\)</span>
trajectories and data points:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">trajectories</span>,</span>
<span>    lty <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_spoke.html" class="external-link">geom_spoke</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">san_andreas.res</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">lon</span>,</span>
<span>      y <span class="op">=</span> <span class="va">lat</span>,</span>
<span>      angle <span class="op">=</span> <span class="fu"><a href="../reference/angle-conversion.html">deg2rad</a></span><span class="op">(</span><span class="fl">90</span> <span class="op">-</span> <span class="va">azi</span><span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="fu"><a href="../reference/deviation_norm.html">deviation_norm</a></span><span class="op">(</span><span class="va">dev</span><span class="op">)</span>,</span>
<span>      alpha <span class="op">=</span> <span class="va">quality</span></span>
<span>    <span class="op">)</span>,</span>
<span>    radius <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    position <span class="op">=</span> <span class="st">"center_spoke"</span>,</span>
<span>    na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span></span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">san_andreas</span><span class="op">$</span><span class="va">lon</span><span class="op">)</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">san_andreas</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="B_datasets_files/figure-html/plot2-1.png" width="700"><!-- ![](san_andreas_map.png) --></p>
<p>The map shows generally low deviation of the observed <span class="math inline">\(\sigma_{Hmax}\)</span> directions from the modeled
stress direction using counter-clockwise 45<span class="math inline">\(^{\circ}\)</span> loxodromes.</p>
<p>The <em>normalized</em> <span class="math inline">\(\chi^2\)</span>
test quantifies the fit between the modeled <span class="math inline">\(\sigma_{Hmax}\)</span> direction the observed
stress direction considering the reported uncertainties of the
measurement.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/norm_chisq.html">norm_chisq</a></span><span class="op">(</span></span>
<span>  obs <span class="op">=</span> <span class="va">san_andreas.res</span><span class="op">$</span><span class="va">azi.PoR</span>,</span>
<span>  prd <span class="op">=</span> <span class="fl">135</span>,</span>
<span>  unc <span class="op">=</span> <span class="va">san_andreas.res</span><span class="op">$</span><span class="va">unc</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.03296388</span></span></code></pre></div>
<p>The value is <span class="math inline">\(\leq\)</span> 0.15,
indicating a significantly good fit of the model. Thus, the traction of
the transform plate boundary explain the stress direction of the
area.</p>
</div>
<div class="section level2">
<h2 id="variation-of-the-direction-of-the-maximum-horizontal-stress-wrt--to-the-distance-to-the-plate-boundary">Variation of the Direction of the Maximum Horizontal Stress wrt. to
the Distance to the Plate Boundary<a class="anchor" aria-label="anchor" href="#variation-of-the-direction-of-the-maximum-horizontal-stress-wrt--to-the-distance-to-the-plate-boundary"></a>
</h2>
<p>The direction of the maximum horizontal stress correlates with plate
motion direction at the plate boundary zone. Towards the plate interior,
plate boundary forces become weaker and other stress sources will
probably dominate.</p>
<p>To visualize the variation of the <span class="math inline">\(\sigma_{Hmax}\)</span> wrt. to the distance to the
plate boundary, we need to transfer the direction of <span class="math inline">\(\sigma_{Hmax}\)</span> from the geographic
reference system (i.e. azimuth is the deviation of a direction from
geographic North pole) to the <strong>Pole of Rotation (PoR)</strong>
reference system (i.e. azimuth is the deviation from the PoR).</p>
<blockquote>
<p>The <em>PoR coordinate reference system</em> is the oblique
transformation of the geographical coordinate system with the PoR
coordinates being the the translation factors.</p>
</blockquote>
<p>The azimuth in the <em>PoR reference system</em> <span class="math inline">\(\alpha_{PoR}\)</span> is the angular difference
between the azimuth in geographic reference system <span class="math inline">\(\alpha_{geo}\)</span> and the (initial) bearing of
the great circle that passes through the data point and the PoR <span class="math inline">\(\theta\)</span>.</p>
<p>To calculate the distance to the plate boundary, both the plate
boundary geometries and the data points (in geographical coordinates)
will be transformed in to the <em>PoR</em> reference system. In the
<em>PoR</em> system, the distance is the latitudinal or longitudinal
difference between the data points and the inward/outward or tangential
moving plate boundaries, respectively.</p>
<p>This is done with the function <code><a href="../reference/distance_from_pb.html">distance_from_pb()</a></code>, which
returns the angular distances.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plate_boundary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">plates</span>, <span class="va">plates</span><span class="op">$</span><span class="va">pair</span> <span class="op">==</span> <span class="st">"na-pa"</span><span class="op">)</span></span>
<span><span class="va">san_andreas.res</span><span class="op">$</span><span class="va">distance</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/distance_from_pb.html">distance_from_pb</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">san_andreas</span>,</span>
<span>    PoR <span class="op">=</span> <span class="va">por</span>,</span>
<span>    pb <span class="op">=</span> <span class="va">plate_boundary</span>,</span>
<span>    tangential <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Finally, we visualize the <span class="math inline">\(\sigma_{Hmax}\)</span> direction wrt. to the
distance to the plate boundary:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">azi_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_andreas.res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">azi.PoR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Distance from plate boundary (\u00B0)"</span>, y <span class="op">=</span> <span class="st">"Azimuth in PoR (\u00B0)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">90</span>, <span class="fl">135</span>, <span class="fl">180</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      ymin <span class="op">=</span> <span class="va">azi.PoR</span> <span class="op">-</span> <span class="va">unc</span>, ymax <span class="op">=</span> <span class="va">azi.PoR</span> <span class="op">+</span> <span class="va">unc</span>,</span>
<span>      color <span class="op">=</span> <span class="va">san_andreas</span><span class="op">$</span><span class="va">regime</span>, alpha <span class="op">=</span> <span class="va">san_andreas</span><span class="op">$</span><span class="va">quality</span></span>
<span>    <span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">.25</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">360</span>, <span class="fl">45</span><span class="op">)</span>,</span>
<span>    sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">sec_axis</a></span><span class="op">(</span></span>
<span>      <span class="op">~</span><span class="va">.</span>,</span>
<span>      name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">90</span>, <span class="fl">135</span>, <span class="fl">180</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Outward"</span>, <span class="st">"Tan (L)"</span>, <span class="st">"Inward"</span>, <span class="st">"Tan (R)"</span>, <span class="st">"Outward"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html" class="external-link">scale_alpha_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Quality rank"</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Tectonic regime"</span>, values <span class="op">=</span> <span class="fu"><a href="../reference/stress_colors.html">stress_colors</a></span><span class="op">(</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/stress_colors.html">stress_colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">azi_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="B_datasets_files/figure-html/san.andreas.distanceplot1-1.png" width="700"><!-- ![](azimuth.png) --></p>
<p>Adding a rolling statistics (e.g. weighted mean and 95% confidence
interval) of the transformed azimuth:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">san_andreas.res_roll</span> <span class="op">&lt;-</span> <span class="va">san_andreas.res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">san_andreas.res</span><span class="op">$</span><span class="va">distance</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">r_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roll_circstats.html">roll_circstats</a></span><span class="op">(</span></span>
<span>  <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">azi.PoR</span>,</span>
<span>  w <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">unc</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">circular_mean</span>, width <span class="op">=</span> <span class="fl">51</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">r_conf95</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rolling_test.html">roll_confidence</a></span><span class="op">(</span></span>
<span>  <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">azi.PoR</span>,</span>
<span>  w <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">unc</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">51</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">azi_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">san_andreas.res_roll</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">distance</span>, <span class="va">r_mean</span> <span class="op">-</span> <span class="va">r_conf95</span><span class="op">)</span>,</span>
<span>    lty <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">san_andreas.res_roll</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">distance</span>, <span class="va">r_mean</span> <span class="op">+</span> <span class="va">r_conf95</span><span class="op">)</span>,</span>
<span>    lty <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">san_andreas.res_roll</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">distance</span>, <span class="va">r_mean</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="B_datasets_files/figure-html/san.andreas.distanceplot1_roll-1.png" width="700"></p>
<p>Close to the dextral plate boundary, the majority of the stress data
have a strike-slip fault regime and are oriented around 135<span class="math inline">\(^{\circ}\)</span> wrt. to the PoR. Thus, the date
are parallel to the predicted stress sourced by a right-lateral
displaced plate boundary. Away from the plate boundary, the data becomes
more noisy.</p>
<blockquote>
<p>This azimuth (PoR) vs. distance plot also allows to identify whether
a less known plate boundary represents a inward, outward, or tangential
displaced boundary.</p>
</blockquote>
<p>The relationship between the azimuth and the distance can be better
visualized by using the deviation (normalized by the data precision)
from the the predicted stress direction, i.e. the <em>normalized</em>
<span class="math inline">\(\chi^2\)</span>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rolling norm chisq:</span></span>
<span><span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">roll_nchisq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rolling_test.html">roll_normchisq</a></span><span class="op">(</span></span>
<span>  <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">azi.PoR</span>,</span>
<span>  <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">prd</span>,</span>
<span>  <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">unc</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">51</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plotting:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_andreas.res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">nchisq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Distance from plate boundary (\u00B0)"</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Norm</span> <span class="op">~</span> <span class="va">chi</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">.33</span>, <span class="fl">.7</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">san_andreas</span><span class="op">$</span><span class="va">regime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">sec_axis</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">.</span>,</span>
<span>    name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.15</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">.33</span>, <span class="fl">.7</span> <span class="op">+</span> <span class="fl">0.15</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Good fit"</span>, <span class="st">"Random"</span>, <span class="st">"Systematic\nmisfit"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Tectonic regime"</span>, values <span class="op">=</span> <span class="fu"><a href="../reference/stress_colors.html">stress_colors</a></span><span class="op">(</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/stress_colors.html">stress_colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">san_andreas.res_roll</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">distance</span>, <span class="va">roll_nchisq</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="B_datasets_files/figure-html/san.andreas.distanceplot2-1.png" width="700"><!-- ![](nchisq.png) --></p>
<p>We can see that the data in fact starts to scatter notably beyond a
distance of 3.8<span class="math inline">\(^{\circ}\)</span> and becomes
random at 7<span class="math inline">\(^{\circ}\)</span> away from the
plate boundary. Thus, the North American-Pacific plate boundary zone at
the San Andreas Fault is approx. 4–7<span class="math inline">\(^{\circ}\)</span> (ca. 380–750 km) wide.</p>
<blockquote>
<p>The <em>normalized</em> <span class="math inline">\(\chi^2\)</span>
vs. distance plot allows to specify the width of the plate boundary
zone.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="r-base-plots-for-quick-analysis">R base plots for quick analysis<a class="anchor" aria-label="anchor" href="#r-base-plots-for-quick-analysis"></a>
</h2>
<p>The data deviation map can also be build using base R’s plotting
engine:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Setup the colors for the deviation</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tectonicr.colors.html">tectonicr.colors</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/deviation_norm.html">deviation_norm</a></span><span class="op">(</span><span class="va">san_andreas.res</span><span class="op">$</span><span class="va">dev</span><span class="op">)</span>,</span>
<span>  categorical <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Setup the legend</span></span>
<span><span class="va">col.legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">cols</span>, val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>val2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\("</span>, <span class="st">""</span>, <span class="va">val</span><span class="op">)</span>, val2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\["</span>, <span class="st">""</span>, <span class="va">val2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">val2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initialize the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">san_andreas</span><span class="op">$</span><span class="va">lon</span>, <span class="va">san_andreas</span><span class="op">$</span><span class="va">lat</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"PoR longitude"</span>, ylab <span class="op">=</span> <span class="st">"PoR latitude"</span>,</span>
<span>  asp <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the axis and colors</span></span>
<span><span class="fu"><a href="../reference/axes.html">axes</a></span><span class="op">(</span></span>
<span>  <span class="va">san_andreas</span><span class="op">$</span><span class="va">lon</span>, <span class="va">san_andreas</span><span class="op">$</span><span class="va">lat</span>, <span class="va">san_andreas</span><span class="op">$</span><span class="va">azi</span>,</span>
<span>  col <span class="op">=</span> <span class="va">cols</span>, add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the plate boundary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">plates</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the trajectories</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">trajectories</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the legend</span></span>
<span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"bottomleft"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"|Deviation| in (\u00B0)"</span>,</span>
<span>  inset <span class="op">=</span> <span class="fl">.05</span>, cex <span class="op">=</span> <span class="fl">.75</span>,</span>
<span>  legend <span class="op">=</span> <span class="va">col.legend</span><span class="op">$</span><span class="va">val</span>, fill <span class="op">=</span> <span class="va">col.legend</span><span class="op">$</span><span class="va">col</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="B_datasets_files/figure-html/plot_base-1.png" width="700"></p>
<p>A quick analysis the results can be obtained
<code><a href="../reference/stress_analysis.html">stress_analysis()</a></code> that returns a list. The transformed
coordinates and azimuths as well as the deviations can be viewed by:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stress_analysis.html">stress_analysis</a></span><span class="op">(</span><span class="va">san_andreas</span>, <span class="va">por</span>, <span class="st">"right"</span>, <span class="va">plate_boundary</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reject Null Hypothesis</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt;    azi.PoR prd        dev       nchisq       cdist  lat.PoR   lon.PoR</span></span>
<span><span class="co">#&gt; 1 162.2848 135  27.284805 0.0919087122 0.210143277 56.93219 -82.67182</span></span>
<span><span class="co">#&gt; 2 137.7446 135   2.744584 0.0009299678 0.002292849 58.01202 -74.48278</span></span>
<span><span class="co">#&gt; 3 119.5840 135 -15.416011 0.0293399256 0.070663207 57.93239 -74.80319</span></span>
<span><span class="co">#&gt; 4 131.1908 135  -3.809243 0.0017913992 0.004413592 57.83707 -75.51138</span></span>
<span><span class="co">#&gt; 5 152.3277 135  17.327717 0.0370678728 0.088706703 58.17336 -76.62093</span></span>
<span><span class="co">#&gt; 6 109.7786 135 -25.221400 0.0785332091 0.181575875 57.84485 -76.16849</span></span>
<span><span class="co">#&gt;      distance</span></span>
<span><span class="co">#&gt; 1 -0.15965337</span></span>
<span><span class="co">#&gt; 2  0.08688785</span></span>
<span><span class="co">#&gt; 3  0.14986772</span></span>
<span><span class="co">#&gt; 4  0.38296977</span></span>
<span><span class="co">#&gt; 5 -0.04424539</span></span>
<span><span class="co">#&gt; 6  0.33684309</span></span></code></pre></div>
<p>Statistical parameters describing the distribution of the transformed
azimuths can be displayed by</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">stats</span></span>
<span><span class="co">#&gt;                    [,1]</span></span>
<span><span class="co">#&gt; mean       138.89370624</span></span>
<span><span class="co">#&gt; sd          37.12227404</span></span>
<span><span class="co">#&gt; var          0.18932742</span></span>
<span><span class="co">#&gt; dispersion   0.09840187</span></span>
<span><span class="co">#&gt; conf95       4.97276197</span></span>
<span><span class="co">#&gt; norm_chisq   0.03296388</span></span></code></pre></div>
<p>Statistical test results are shown by</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">test</span></span>
<span><span class="co">#&gt; $statistic</span></span>
<span><span class="co">#&gt; [1] 0.8031963</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p.value</span></span>
<span><span class="co">#&gt; [1] 3.607527e-47</span></span></code></pre></div>
<p>… and the associated plots can be displayed by setting
<code>plot = TRUE</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/stress_analysis.html">stress_analysis</a></span><span class="op">(</span><span class="va">san_andreas</span>, <span class="va">por</span>, <span class="st">"right"</span>, <span class="va">plate_boundary</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Bird, Peter. 2003. “An Updated Digital Model of Plate Boundaries”
<em>Geochemistry, Geophysics, Geosystems</em> 4 (3). doi:
10.1029/2001gc000252.
<!---[10.1029/2001gc000252](https://doi.org/10.1029/2001GC000252).--></p>
<p>DeMets, C., R. G. Gordon, D. F. Argus, and S. Stein. 1990. “Current
Plate Motions” <em>Geophysical Journal International</em> 101 (2):
425–78. doi: <a href="https://doi.org/10.1111/j.1365-246x.1990.tb06579.x" class="external-link">10.1111/j.1365-246x.1990.tb06579.x</a>.</p>
<p>Heidbach, Oliver, Mojtaba Rajabi, Karsten Reiter, Moritz Ziegler, and
WSM Team. 2016. “World Stress Map Database Release 2016. V. 1.1.” GFZ
Data Services. doi: <a href="https://doi.org/10.5880/WSM.2016.001" class="external-link">10.5880/WSM.2016.001</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://tobiasstephan1.wixsite.com/tobi" class="external-link">Tobias Stephan</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
